<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cocktail Bar - Enhanced</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Space+Mono:wght@400;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #151520;
            --bg-tertiary: #1e1e2e;
            --card-bg: rgba(25, 25, 40, 0.6);
            --card-border: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: #a8a8b8;
            --text-muted: #6b6b7b;
            --accent-gold: #d4af37;
            --accent-rose: #ff6b9d;
            --accent-cyan: #00d4ff;
            --accent-lime: #a8ff35;
            --danger: #ff4757;
            --success: #2ed573;
            --warning: #ffa502;
            --glass-shine: rgba(255, 255, 255, 0.15);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --radius-lg: 20px;
            --radius-xl: 28px;
        }

        body {
            font-family: 'DM Sans', -apple-system, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a0a1f 50%, #0a0f1a 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 20% 50%, rgba(212, 175, 55, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(0, 212, 255, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 40% 20%, rgba(255, 107, 157, 0.02) 0%, transparent 50%);
            animation: drift 60s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes drift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(5%, 10%) rotate(3deg); }
            66% { transform: translate(-5%, 5%) rotate(-3deg); }
        }

        /* Layout */
        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.5rem, 5vw, 4.5rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-gold) 0%, var(--accent-rose) 50%, var(--accent-cyan) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-family: 'Space Mono', monospace;
            color: var(--text-secondary);
            font-size: 0.9rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }

        .bento-grid {
            display: grid;
            grid-template-columns: 320px 380px 1fr;
            grid-template-rows: auto auto 1fr;
            gap: 20px;
            animation: fadeIn 1s ease 0.2s both;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-xl);
            padding: 28px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-shine), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card:hover::before {
            opacity: 1;
        }

        .card:hover {
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .card-icon {
            font-size: 1.5rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .card-title {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-weight: 700;
        }

        /* Form Elements */
        select, input[type="number"] {
            width: 100%;
            padding: 14px 16px;
            margin-bottom: 14px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            color: var(--text-primary);
            border-radius: var(--radius-lg);
            font-size: 0.95rem;
            font-family: 'DM Sans', sans-serif;
            outline: none;
            transition: all 0.2s;
            cursor: pointer;
        }

        select:hover, input[type="number"]:hover {
            border-color: rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.05);
        }

        select:focus, input[type="number"]:focus {
            border-color: var(--accent-cyan);
            background: rgba(0, 212, 255, 0.05);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
        }

        /* Toggle Switch */
        .toggle-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: var(--radius-lg);
            margin-bottom: 14px;
            transition: all 0.2s;
        }

        .toggle-row:hover {
            background: rgba(255, 255, 255, 0.04);
        }

        .toggle-label {
            font-size: 0.95rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .switch {
            position: relative;
            width: 56px;
            height: 28px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 34px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        input:checked + .slider {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-lime));
        }

        input:checked + .slider:before {
            transform: translateX(28px);
        }

        /* Buttons */
        button {
            padding: 14px 24px;
            border-radius: var(--radius-lg);
            border: none;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'DM Sans', sans-serif;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::before {
            width: 300px;
            height: 300px;
        }

        button:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-lime) 100%);
            color: #000;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 25px rgba(0, 212, 255, 0.4);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #c23616 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3);
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: auto;
        }

        .btn-group button {
            flex: 1;
        }

        /* Stats Display */
        .stats-grid {
            display: grid;
            gap: 14px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.02);
            padding: 18px;
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.04);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 8px;
            font-family: 'Space Mono', monospace;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'Space Mono', monospace;
            display: flex;
            align-items: baseline;
            gap: 6px;
        }

        .stat-unit {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .stat-high { color: var(--danger); }
        .stat-mid { color: var(--warning); }
        .stat-low { color: var(--success); }

        /* Preset Buttons */
        .preset-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .preset-btn {
            padding: 16px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .preset-btn:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: var(--accent-gold);
            transform: translateY(-2px);
        }

        .preset-name {
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .preset-desc {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Mix List */
        .mix-list {
            flex-grow: 1;
            overflow-y: auto;
            margin: 16px 0;
            max-height: 350px;
            padding-right: 8px;
        }

        .mix-list::-webkit-scrollbar {
            width: 6px;
        }

        .mix-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
        }

        .mix-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .mix-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .mix-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px;
            background: rgba(255, 255, 255, 0.02);
            margin-bottom: 8px;
            border-radius: var(--radius-lg);
            border-left: 3px solid transparent;
            transition: all 0.2s;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .mix-item:hover {
            background: rgba(255, 255, 255, 0.04);
            transform: translateX(4px);
        }

        .mix-item-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mix-color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .mix-item-name {
            font-weight: 500;
        }

        .mix-item-volume {
            font-family: 'Space Mono', monospace;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .mix-item-remove {
            background: rgba(255, 71, 87, 0.1);
            border: none;
            color: var(--danger);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 1.2rem;
            padding: 0;
        }

        .mix-item-remove:hover {
            background: var(--danger);
            color: white;
            transform: rotate(90deg);
        }

        /* Visual Area */
        .area-visual {
            grid-column: 3 / 4;
            grid-row: 1 / 4;
            background: radial-gradient(ellipse at center, rgba(30, 30, 46, 0.8) 0%, rgba(10, 10, 15, 0.95) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .area-visual::before {
            content: '';
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(circle at 30% 40%, rgba(212, 175, 55, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 70% 60%, rgba(0, 212, 255, 0.08) 0%, transparent 50%);
            pointer-events: none;
            animation: pulse 8s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        canvas {
            max-width: 100%;
            max-height: 100%;
            filter: drop-shadow(0 20px 40px rgba(0, 0, 0, 0.6));
            position: relative;
            z-index: 1;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 0.9rem;
        }

        /* Input Group */
        .input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 14px;
        }

        .input-group input,
        .input-group select {
            margin-bottom: 0;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Grid Areas */
        .area-glass { grid-column: 1 / 2; grid-row: 1 / 2; }
        .area-stats { grid-column: 1 / 2; grid-row: 2 / 4; }
        .area-controls { grid-column: 2 / 3; grid-row: 1 / 4; display: flex; flex-direction: column; }

        /* Responsive */
        @media (max-width: 1200px) {
            .bento-grid {
                grid-template-columns: 1fr 1fr;
                grid-template-rows: auto;
            }
            .area-visual {
                grid-column: 1 / 3;
                min-height: 600px;
                order: -1;
            }
            .area-controls {
                grid-column: 1 / 3;
            }
        }

        @media (max-width: 768px) {
            .bento-grid {
                grid-template-columns: 1fr;
            }
            .area-glass,
            .area-stats,
            .area-controls,
            .area-visual {
                grid-column: 1 / 2;
            }
            .preset-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Shake Animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px) rotate(-2deg); }
            20%, 40%, 60%, 80% { transform: translateX(5px) rotate(2deg); }
        }

        .shaking {
            animation: shake 0.5s ease-in-out;
        }

        /* Search Input */
        .search-box {
            position: relative;
            margin-bottom: 14px;
        }

        .search-box input {
            padding-left: 40px;
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <h1>Cocktail Bar</h1>
        <p class="subtitle">Craft Cocktails ¬∑ Visualized</p>
    </header>

    <div class="bento-grid">
        
        <!-- Vessel & Presentation Card -->
        <div class="card area-glass">
            <div class="card-header">
                <span class="card-icon">üç∏</span>
                <h3 class="card-title">Vessel & Style</h3>
            </div>
            
            <select id="glassType" onchange="renderApp()">
                <option value="highball">Highball Glass</option>
                <option value="rocks">Rocks Glass</option>
                <option value="martini">Martini Glass</option>
                <option value="coupe">Coupe Glass</option>
                <option value="hurricane">Hurricane Glass</option>
                <option value="glencairn">Glencairn (Whiskey)</option>
            </select>

            <div class="toggle-row">
                <span class="toggle-label">
                    <span>üßä</span>
                    <span>Add Ice</span>
                </span>
                <label class="switch">
                    <input type="checkbox" id="iceToggle" onchange="renderApp()">
                    <span class="slider"></span>
                </label>
            </div>

            <label style="font-size:0.85rem; margin-bottom:8px; display:block; color: var(--text-secondary);">Garnish</label>
            <select id="garnishType" onchange="renderApp()">
                <option value="">None</option>
                <option value="üçã">üçã Lemon Wheel</option>
                <option value="ü•í">ü•í Cucumber Slice</option>
                <option value="üçí">üçí Maraschino Cherry</option>
                <option value="üåø">üåø Mint Sprig</option>
                <option value="üçä">üçä Orange Peel</option>
                <option value="ü´í">ü´í Olive</option>
                <option value="üçì">üçì Strawberry</option>
            </select>
        </div>

        <!-- Stats Card -->
        <div class="card area-stats">
            <div class="card-header">
                <span class="card-icon">üìä</span>
                <h3 class="card-title">Drink Analytics</h3>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Volume</div>
                    <div class="stat-value">
                        <span id="statVol">0</span>
                        <span class="stat-unit">ml</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-label">Strength (ABV)</div>
                    <div class="stat-value" id="statABV">
                        <span>0</span>
                        <span class="stat-unit">%</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-label">Calories</div>
                    <div class="stat-value">
                        <span id="statCal">0</span>
                        <span class="stat-unit">kcal</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-label">Est. Cost</div>
                    <div class="stat-value" style="color: var(--accent-gold);">
                        <span id="statCost">$0.00</span>
                    </div>
                </div>
            </div>

            <div style="margin-top: 28px;">
                <div class="card-header" style="margin-bottom: 16px; padding-bottom: 12px;">
                    <span class="card-icon">‚≠ê</span>
                    <h3 class="card-title">Classic Recipes</h3>
                </div>
                <div class="preset-grid">
                    <button class="preset-btn" onclick="loadPreset('mojito')">
                        <div class="preset-name">üåø Mojito</div>
                        <div class="preset-desc">Fresh & minty</div>
                    </button>
                    <button class="preset-btn" onclick="loadPreset('negroni')">
                        <div class="preset-name">üçä Negroni</div>
                        <div class="preset-desc">Bold & bitter</div>
                    </button>
                    <button class="preset-btn" onclick="loadPreset('martini')">
                        <div class="preset-name">ü´í Martini</div>
                        <div class="preset-desc">Classic & dry</div>
                    </button>
                    <button class="preset-btn" onclick="loadPreset('zombie')">
                        <div class="preset-name">üçπ Zombie</div>
                        <div class="preset-desc">Tropical & strong</div>
                    </button>
                    <button class="preset-btn" onclick="loadPreset('oldFashioned')">
                        <div class="preset-name">ü•É Old Fashioned</div>
                        <div class="preset-desc">Smooth & sophisticated</div>
                    </button>
                    <button class="preset-btn" onclick="loadPreset('margarita')">
                        <div class="preset-name">üçã Margarita</div>
                        <div class="preset-desc">Tart & refreshing</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mixer Station Card -->
        <div class="card area-controls">
            <div class="card-header">
                <span class="card-icon">üß™</span>
                <h3 class="card-title">Mixer Station</h3>
            </div>
            
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchBox" placeholder="Search ingredients..." oninput="filterIngredients()">
            </div>

            <select id="catFilter" onchange="populateIngredients()">
                <option value="all">All Categories</option>
                <option value="spirit">ü•É Spirits</option>
                <option value="liqueur">üç∑ Liqueurs</option>
                <option value="mixer">üßÉ Juices & Mixers</option>
                <option value="syrup">üçØ Syrups</option>
            </select>

            <select id="ingSelect"></select>

            <div class="input-group">
                <input type="number" id="ingAmount" placeholder="Qty" value="30" min="1" max="500">
                <select id="ingUnit">
                    <option value="ml">ml</option>
                    <option value="oz">oz</option>
                    <option value="cl">cl</option>
                    <option value="dash">dash</option>
                </select>
            </div>

            <button class="btn-primary" onclick="addIngredient()" style="margin-bottom: 14px; width: 100%;">
                <span style="position: relative; z-index: 1;">‚ú® Pour Ingredient</span>
            </button>

            <div class="mix-list" id="mixList">
                <div class="empty-state">
                    <div class="empty-state-icon">üçπ</div>
                    <div class="empty-state-text">Start adding ingredients<br>to craft your cocktail</div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn-secondary" id="shakeBtn" onclick="toggleShake()">
                    <span style="position: relative; z-index: 1;">ü•É Shake</span>
                </button>
                <button class="btn-danger" onclick="resetGlass()">
                    <span style="position: relative; z-index: 1;">üóëÔ∏è Clear</span>
                </button>
            </div>
        </div>

        <!-- Visual Area -->
        <div class="card area-visual">
            <canvas id="canvas" width="500" height="700"></canvas>
        </div>

    </div>
</div>

<script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 1. DATABASE - Enhanced with more ingredients
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const DB = {
        // Spirits
        'vodka': { name: 'Vodka', type: 'spirit', color: '#dceeff', abv: 40, cal: 231, cost: 0.03, bubble: false },
        'gin': { name: 'Dry Gin', type: 'spirit', color: '#eef9ff', abv: 40, cal: 263, cost: 0.04, bubble: false },
        'white_rum': { name: 'White Rum', type: 'spirit', color: '#e8f4f8', abv: 40, cal: 231, cost: 0.03, bubble: false },
        'dark_rum': { name: 'Dark Rum', type: 'spirit', color: '#5C2C0C', abv: 40, cal: 231, cost: 0.04, bubble: false },
        'tequila': { name: 'Tequila Blanco', type: 'spirit', color: '#f4ebd0', abv: 40, cal: 231, cost: 0.05, bubble: false },
        'whiskey': { name: 'Bourbon Whiskey', type: 'spirit', color: '#d4a574', abv: 40, cal: 250, cost: 0.05, bubble: false },
        'scotch': { name: 'Scotch', type: 'spirit', color: '#d4af37', abv: 40, cal: 250, cost: 0.06, bubble: false },
        'cognac': { name: 'Cognac', type: 'spirit', color: '#8B4513', abv: 40, cal: 240, cost: 0.08, bubble: false },
        'mezcal': { name: 'Mezcal', type: 'spirit', color: '#f5f5dc', abv: 40, cal: 231, cost: 0.06, bubble: false },
        
        // Liqueurs
        'triplesec': { name: 'Triple Sec', type: 'liqueur', color: '#ffffff', abv: 30, cal: 300, cost: 0.03, bubble: false },
        'coffee': { name: 'Coffee Liqueur', type: 'liqueur', color: '#26130b', abv: 20, cal: 350, cost: 0.04, bubble: false },
        'baileys': { name: 'Irish Cream', type: 'liqueur', color: '#dabba0', abv: 17, cal: 327, cost: 0.04, bubble: false },
        'campari': { name: 'Campari', type: 'liqueur', color: '#b5121b', abv: 24, cal: 260, cost: 0.04, bubble: false },
        'vermouth_sweet': { name: 'Sweet Vermouth', type: 'liqueur', color: '#6e1d1d', abv: 16, cal: 160, cost: 0.02, bubble: false },
        'vermouth_dry': { name: 'Dry Vermouth', type: 'liqueur', color: '#f0f5f5', abv: 16, cal: 120, cost: 0.02, bubble: false },
        'blue_curacao': { name: 'Blue Cura√ßao', type: 'liqueur', color: '#0055ff', abv: 20, cal: 240, cost: 0.02, bubble: false },
        'cointreau': { name: 'Cointreau', type: 'liqueur', color: '#ffebcd', abv: 40, cal: 320, cost: 0.05, bubble: false },
        'aperol': { name: 'Aperol', type: 'liqueur', color: '#ff6347', abv: 11, cal: 150, cost: 0.03, bubble: false },
        'chartreuse': { name: 'Green Chartreuse', type: 'liqueur', color: '#7FFF00', abv: 55, cal: 380, cost: 0.08, bubble: false },
        'drambuie': { name: 'Drambuie', type: 'liqueur', color: '#FFD700', abv: 40, cal: 340, cost: 0.06, bubble: false },

        // Mixers & Juices
        'lime': { name: 'Lime Juice', type: 'mixer', color: '#d8e8b5', abv: 0, cal: 25, cost: 0.01, bubble: false },
        'lemon': { name: 'Lemon Juice', type: 'mixer', color: '#fffacd', abv: 0, cal: 25, cost: 0.01, bubble: false },
        'orange': { name: 'Orange Juice', type: 'mixer', color: '#ffa500', abv: 0, cal: 45, cost: 0.01, bubble: false },
        'pineapple': { name: 'Pineapple Juice', type: 'mixer', color: '#ffe135', abv: 0, cal: 50, cost: 0.01, bubble: false },
        'cranberry': { name: 'Cranberry Juice', type: 'mixer', color: '#dc143c', abv: 0, cal: 46, cost: 0.01, bubble: false },
        'grapefruit': { name: 'Grapefruit Juice', type: 'mixer', color: '#ff6b6b', abv: 0, cal: 39, cost: 0.01, bubble: false },
        'tomato': { name: 'Tomato Juice', type: 'mixer', color: '#ff6347', abv: 0, cal: 17, cost: 0.01, bubble: false },
        'cola': { name: 'Cola', type: 'mixer', color: '#2a1c17', abv: 0, cal: 42, cost: 0.01, bubble: true },
        'tonic': { name: 'Tonic Water', type: 'mixer', color: '#f0f8ff', abv: 0, cal: 34, cost: 0.01, bubble: true },
        'soda': { name: 'Soda Water', type: 'mixer', color: '#ffffff', abv: 0, cal: 0, cost: 0.005, bubble: true },
        'ginger': { name: 'Ginger Beer', type: 'mixer', color: '#f4a460', abv: 0, cal: 45, cost: 0.02, bubble: true },
        'coconut': { name: 'Coconut Cream', type: 'mixer', color: '#fffef0', abv: 0, cal: 330, cost: 0.02, bubble: false },

        // Syrups
        'grenadine': { name: 'Grenadine', type: 'syrup', color: '#c20000', abv: 0, cal: 260, cost: 0.01, bubble: false },
        'simple': { name: 'Simple Syrup', type: 'syrup', color: '#ffffff', abv: 0, cal: 200, cost: 0.005, bubble: false },
        'honey': { name: 'Honey Syrup', type: 'syrup', color: '#FFD700', abv: 0, cal: 304, cost: 0.01, bubble: false },
        'agave': { name: 'Agave Nectar', type: 'syrup', color: '#FFE4B5', abv: 0, cal: 310, cost: 0.01, bubble: false },
        'angostura': { name: 'Angostura Bitters', type: 'syrup', color: '#5C1F1B', abv: 45, cal: 0, cost: 0.02, bubble: false },
    };

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 2. STATE MANAGEMENT
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let mix = [];
    let isShaken = false;
    let allIngredientKeys = Object.keys(DB);

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 3. CANVAS RENDERING ENGINE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Glass geometries with improved dimensions
    const glasses = {
        highball: (x, y) => {
            ctx.beginPath();
            ctx.moveTo(x-50, y);
            ctx.lineTo(x-45, y+380);
            ctx.lineTo(x+45, y+380);
            ctx.lineTo(x+50, y);
            ctx.closePath();
            return {top: y, bottom: y+380, w: 100};
        },
        rocks: (x, y) => {
            ctx.beginPath();
            ctx.moveTo(x-70, y+200);
            ctx.lineTo(x-60, y+380);
            ctx.lineTo(x+60, y+380);
            ctx.lineTo(x+70, y+200);
            ctx.closePath();
            return {top: y+200, bottom: y+380, w: 140};
        },
        martini: (x, y) => {
            ctx.beginPath();
            ctx.moveTo(x-120, y+120);
            ctx.lineTo(x, y+280);
            ctx.lineTo(x+120, y+120);
            ctx.closePath();
            return {top: y+120, bottom: y+280, w: 240};
        },
        coupe: (x, y) => {
            ctx.beginPath();
            ctx.arc(x, y+180, 100, 0, Math.PI, false);
            ctx.lineTo(x-100, y+180);
            ctx.closePath();
            return {top: y+180, bottom: y+280, w: 200};
        },
        hurricane: (x, y) => {
            ctx.beginPath();
            ctx.moveTo(x-45, y+50);
            ctx.bezierCurveTo(x-65, y+120, x-65, y+220, x-30, y+300);
            ctx.lineTo(x-35, y+380);
            ctx.lineTo(x+35, y+380);
            ctx.lineTo(x+30, y+300);
            ctx.bezierCurveTo(x+65, y+220, x+65, y+120, x+45, y+50);
            ctx.closePath();
            return {top: y+50, bottom: y+380, w: 110};
        },
        glencairn: (x, y) => {
            ctx.beginPath();
            ctx.moveTo(x-30, y+120);
            ctx.bezierCurveTo(x-15, y+180, x-60, y+280, x-35, y+380);
            ctx.lineTo(x+35, y+380);
            ctx.bezierCurveTo(x+60, y+280, x+15, y+180, x+30, y+120);
            ctx.closePath();
            return {top: y+120, bottom: y+380, w: 90};
        }
    };

    // Color utilities
    function adjustColor(hex, amt) {
        let usePound = false;
        if (hex[0] === "#") { hex = hex.slice(1); usePound = true; }
        let num = parseInt(hex, 16);
        let r = Math.max(0, Math.min(255, (num >> 16) + amt));
        let g = Math.max(0, Math.min(255, ((num >> 8) & 0x00FF) + amt));
        let b = Math.max(0, Math.min(255, (num & 0x0000FF) + amt));
        return (usePound ? "#" : "") + (b | (g << 8) | (r << 16)).toString(16).padStart(6, '0');
    }

    function blendColors(ingredients) {
        let r=0, g=0, b=0, totalVol=0;
        ingredients.forEach(ing => {
            let hex = ing.color.replace('#','');
            let bigint = parseInt(hex, 16);
            r += ((bigint >> 16) & 255) * ing.volume;
            g += ((bigint >> 8) & 255) * ing.volume;
            b += (bigint & 255) * ing.volume;
            totalVol += ing.volume;
        });
        if(totalVol === 0) return '#ffffff';
        r = Math.round(r/totalVol);
        g = Math.round(g/totalVol);
        b = Math.round(b/totalVol);
        return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        const glassType = document.getElementById('glassType').value;
        const hasIce = document.getElementById('iceToggle').checked;
        const garnish = document.getElementById('garnishType').value;
        const centerX = canvas.width / 2;
        const topY = 120;
        
        // Draw ghost glass outline
        ctx.save();
        const dims = glasses[glassType](centerX, topY);
        ctx.fillStyle = 'rgba(255, 255, 255, 0.03)';
        ctx.fill();
        ctx.restore();

        // Render liquid
        if (mix.length > 0) {
            ctx.save();
            glasses[glassType](centerX, topY);
            ctx.clip();

            let currentY = dims.bottom;
            let glassScale = glassType === 'martini' ? 1.3 : glassType === 'coupe' ? 1.2 : 0.9;

            if (isShaken) {
                // Blended appearance
                const totalVol = mix.reduce((a,b) => a + b.volume, 0);
                const blendedColor = blendColors(mix);
                const height = totalVol * glassScale * (hasIce ? 1.25 : 1);

                const grad = ctx.createLinearGradient(centerX - 60, 0, centerX + 60, 0);
                grad.addColorStop(0, adjustColor(blendedColor, -70));
                grad.addColorStop(0.5, blendedColor);
                grad.addColorStop(1, adjustColor(blendedColor, -70));

                ctx.fillStyle = grad;
                ctx.fillRect(0, currentY - height, canvas.width, height);
                
                // Foam effect
                ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';
                ctx.fillRect(0, currentY - height, canvas.width, 8);
                
                // Add texture
                for(let i = 0; i < 15; i++) {
                    ctx.fillStyle = `rgba(255, 255, 255, ${Math.random() * 0.1})`;
                    ctx.beginPath();
                    ctx.arc(
                        centerX - 40 + Math.random() * 80,
                        currentY - height + Math.random() * height,
                        1 + Math.random() * 2,
                        0, Math.PI * 2
                    );
                    ctx.fill();
                }

            } else {
                // Layered appearance
                [...mix].forEach(ing => {
                    let h = ing.volume * glassScale * (hasIce ? 1.25 : 1);

                    const grad = ctx.createLinearGradient(centerX - 60, 0, centerX + 60, 0);
                    grad.addColorStop(0, adjustColor(ing.color, -60));
                    grad.addColorStop(0.4, ing.color);
                    grad.addColorStop(0.6, ing.color);
                    grad.addColorStop(1, adjustColor(ing.color, -60));

                    ctx.fillStyle = grad;
                    ctx.fillRect(0, currentY - h, canvas.width, h);
                    
                    // Bubbles for carbonated drinks
                    if(ing.bubble) {
                        for(let i = 0; i < 8; i++) {
                            ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                            ctx.beginPath();
                            ctx.arc(
                                centerX - 30 + Math.random() * 60,
                                currentY - Math.random() * h,
                                1 + Math.random() * 3,
                                0, Math.PI * 2
                            );
                            ctx.fill();
                        }
                    }

                    currentY -= h;
                });
            }

            // Ice cubes
            if(hasIce) {
                const fillHeight = dims.bottom - currentY;
                if (fillHeight > 20) {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
                    ctx.lineWidth = 1;
                    
                    for(let i = 0; i < 6; i++) {
                        let size = 25 + Math.random() * 20;
                        let ix = centerX - 40 + Math.random() * 80;
                        let iy = dims.bottom - 30 - Math.random() * (fillHeight - 30);
                        
                        ctx.save();
                        ctx.translate(ix, iy);
                        ctx.rotate(Math.random() * 0.5 - 0.25);
                        ctx.fillRect(-size/2, -size/2, size, size);
                        ctx.strokeRect(-size/2, -size/2, size, size);
                        
                        // Highlight
                        ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
                        ctx.fillRect(-size/2, -size/2, size/3, size/3);
                        ctx.restore();
                    }
                }
            }

            ctx.restore();
        }

        // Glass outline and shine
        ctx.save();
        glasses[glassType](centerX, topY);
        ctx.lineWidth = 3;
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.stroke();

        // Specular highlights
        // ctx.strokeStyle = 'rgba(255, 255, 255, 0.15)';
        // ctx.lineWidth = 2;
        // ctx.beginPath();
        // ctx.moveTo(centerX + 40, topY + 60);
        // ctx.lineTo(centerX + 40, dims.bottom - 60);
        // ctx.stroke();

        // Secondary highlight
        // ctx.strokeStyle = 'rgba(255, 255, 255, 0.08)';
        // ctx.lineWidth = 1;
        // ctx.beginPath();
        // ctx.moveTo(centerX - 35, topY + 60);
        // ctx.lineTo(centerX - 35, dims.bottom - 60);
        // ctx.stroke();

        // Stem and base for stemmed glasses
        if(['martini', 'coupe', 'hurricane', 'glencairn'].includes(glassType)) {
            ctx.beginPath();
            ctx.moveTo(centerX, dims.bottom);
            ctx.lineTo(centerX, dims.bottom + 70);
            
            // Base
            ctx.moveTo(centerX - 40, dims.bottom + 70);
            ctx.lineTo(centerX + 40, dims.bottom + 70);
            
            ctx.lineWidth = 5;
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.stroke();
            
            // Base circle
            ctx.beginPath();
            ctx.ellipse(centerX, dims.bottom + 70, 40, 8, 0, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.fill();
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 2;
            ctx.stroke();
        }
        ctx.restore();

        // Garnish
        if(garnish) {
            ctx.font = "48px Arial";
            ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
            ctx.shadowBlur = 10;
            ctx.fillText(garnish, centerX + 45, dims.top - 20);
            ctx.shadowBlur = 0;
        }
    }

    function renderApp() {
        draw();
        updateStats();
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 4. INGREDIENT & MIX MANAGEMENT
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    function populateIngredients() {
        const cat = document.getElementById('catFilter').value;
        const searchTerm = document.getElementById('searchBox').value.toLowerCase();
        const select = document.getElementById('ingSelect');
        select.innerHTML = '';
        
        let filtered = allIngredientKeys.filter(key => {
            const item = DB[key];
            const matchesCat = cat === 'all' || item.type === cat;
            const matchesSearch = item.name.toLowerCase().includes(searchTerm);
            return matchesCat && matchesSearch;
        });

        filtered.sort((a, b) => DB[a].name.localeCompare(DB[b].name));

        filtered.forEach(key => {
            const item = DB[key];
            const opt = document.createElement('option');
            opt.value = key;
            opt.innerText = item.name;
            select.appendChild(opt);
        });
    }

    function filterIngredients() {
        populateIngredients();
    }

    function addIngredient(id, amount) {
        if(!id) {
            id = document.getElementById('ingSelect').value;
            const unit = document.getElementById('ingUnit').value;
            let val = parseFloat(document.getElementById('ingAmount').value);
            
            // Unit conversions
            if(unit === 'oz') val *= 29.57;
            else if(unit === 'cl') val *= 10;
            else if(unit === 'dash') val = 1;
            
            amount = val;
        }
        
        if(!amount || amount <= 0 || isNaN(amount)) return;

        const dbItem = DB[id];
        mix.push({ ...dbItem, volume: amount, id: id, uniqueId: Date.now() + Math.random() });
        isShaken = false;
        
        renderApp();
        updateMixList();
    }

    function removeIngredient(uniqueId) {
        mix = mix.filter(item => item.uniqueId !== uniqueId);
        renderApp();
        updateMixList();
    }

    function toggleShake() {
        if(mix.length === 0) return;
        
        isShaken = !isShaken;
        const btn = document.getElementById('shakeBtn');
        btn.innerText = isShaken ? 'üç∏ Un-Mix' : 'ü•É Shake';
        
        // Add shake animation to canvas
        canvas.classList.add('shaking');
        setTimeout(() => canvas.classList.remove('shaking'), 500);
        
        renderApp();
    }

    function resetGlass() {
        mix = [];
        isShaken = false;
        document.getElementById('shakeBtn').innerText = 'ü•É Shake';
        renderApp();
        updateMixList();
    }

    function updateStats() {
        let totalVol = 0;
        let totalAlc = 0;
        let totalCal = 0;
        let totalCost = 0;

        mix.forEach(m => {
            totalVol += m.volume;
            totalAlc += m.volume * (m.abv / 100);
            totalCal += (m.volume / 100) * m.cal;
            totalCost += m.volume * m.cost;
        });

        const abv = totalVol > 0 ? (totalAlc / totalVol) * 100 : 0;

        document.getElementById('statVol').innerText = Math.round(totalVol);
        
        const abvEl = document.getElementById('statABV');
        const abvValue = abv.toFixed(1);
        abvEl.innerHTML = `<span>${abvValue}</span><span class="stat-unit">%</span>`;
        abvEl.className = "stat-value " + (abv > 25 ? 'stat-high' : (abv > 10 ? 'stat-mid' : 'stat-low'));

        document.getElementById('statCal').innerText = Math.round(totalCal);
        document.getElementById('statCost').innerText = "$" + totalCost.toFixed(2);
    }

    function updateMixList() {
        const list = document.getElementById('mixList');
        
        if(mix.length === 0) {
            list.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">üçπ</div>
                    <div class="empty-state-text">Start adding ingredients<br>to craft your cocktail</div>
                </div>
            `;
            return;
        }

        list.innerHTML = [...mix].reverse().map(m => `
            <div class="mix-item" style="border-left-color: ${m.color}">
                <div class="mix-item-info">
                    <div class="mix-color-dot" style="background: ${m.color};"></div>
                    <span class="mix-item-name">${m.name}</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="mix-item-volume">${Math.round(m.volume)} ml</span>
                    <button class="mix-item-remove" onclick="removeIngredient(${m.uniqueId})" title="Remove">√ó</button>
                </div>
            </div>
        `).join('');
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 5. RECIPE PRESETS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    const RECIPES = {
        mojito: {
            g: 'highball',
            ice: true,
            gar: 'üåø',
            ings: [['lime', 30], ['simple', 20], ['white_rum', 60], ['soda', 100]]
        },
        negroni: {
            g: 'rocks',
            ice: true,
            gar: 'üçä',
            ings: [['gin', 30], ['campari', 30], ['vermouth_sweet', 30]]
        },
        martini: {
            g: 'martini',
            ice: false,
            gar: 'ü´í',
            ings: [['vermouth_dry', 15], ['gin', 75]]
        },
        zombie: {
            g: 'hurricane',
            ice: true,
            gar: 'üçí',
            ings: [['white_rum', 30], ['dark_rum', 30], ['lime', 20], ['pineapple', 30], ['grenadine', 15]]
        },
        oldFashioned: {
            g: 'rocks',
            ice: true,
            gar: 'üçä',
            ings: [['whiskey', 60], ['simple', 10], ['angostura', 2]]
        },
        margarita: {
            g: 'coupe',
            ice: false,
            gar: 'üçã',
            ings: [['tequila', 50], ['triplesec', 25], ['lime', 25]]
        }
    };

    function loadPreset(key) {
        resetGlass();
        const r = RECIPES[key];
        document.getElementById('glassType').value = r.g;
        document.getElementById('iceToggle').checked = r.ice;
        document.getElementById('garnishType').value = r.gar;
        
        let delay = 0;
        r.ings.forEach(([id, vol]) => {
            setTimeout(() => addIngredient(id, vol), delay);
            delay += 150;
        });
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 6. INITIALIZATION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    populateIngredients();
    renderApp();
    
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' && e.target.tagName !== 'BUTTON') {
            addIngredient();
        }
        if(e.key === 'Escape') {
            resetGlass();
        }
    });

    // Responsive canvas handling
    window.addEventListener('resize', () => {
        renderApp();
    });

</script>

</body>
</html>