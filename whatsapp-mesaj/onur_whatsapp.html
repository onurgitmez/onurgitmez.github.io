<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>ikas WhatsApp Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        .glass {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        .glass-dark {
            background: rgba(17, 24, 39, 0.90); /* Darker opacity for better readability */
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes gradient-xy {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .animate-gradient {
            background-size: 200% 200%;
            animation: gradient-xy 15s ease infinite;
        }
        
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: rgba(156, 163, 175, 0.5); border-radius: 20px; }
        .custom-scroll:hover::-webkit-scrollbar-thumb { background-color: rgba(156, 163, 175, 0.8); }
        
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        [v-cloak] { display: none; }
    </style>
</head>
<body class="antialiased h-screen overflow-hidden relative selection:bg-purple-500 selection:text-white">

    <div id="app" v-cloak class="h-full w-full relative transition-colors duration-500" :class="isDarkMode ? 'text-gray-100' : 'text-gray-900'">
        
        <div class="absolute inset-0 -z-10 animate-gradient" 
             :class="isDarkMode ? 'bg-gradient-to-br from-gray-900 via-gray-800 to-black' : 'bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50'">
        </div>
        
        <div v-if="!isAuthenticated" class="absolute inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-xl bg-black/40">
            <div class="w-full max-w-md p-8 rounded-3xl shadow-2xl text-center transition-all border" 
                 :class="isDarkMode ? 'glass-dark border-gray-700' : 'glass bg-white/90 border-white/50'">
                
                <div class="mb-6 flex justify-center">
                    <div class="p-4 rounded-2xl shadow-xl transition-colors" :class="isDarkMode ? 'bg-white text-black' : 'bg-black text-white'">
                        <svg viewBox="0 0 24 24" fill="currentColor" class="h-8 w-8">
                            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z" />
                        </svg>
                    </div>
                </div>

                <h2 class="text-2xl font-bold mb-2 transition-colors" :class="isDarkMode ? 'text-white' : 'text-gray-900'">
                    ikas SatÄ±ÅŸ Ekibi
                </h2>
                <p class="text-sm mb-6 transition-colors" :class="isDarkMode ? 'text-gray-300' : 'text-gray-600'">
                    Ä°Ã§erikleri gÃ¶rÃ¼ntÃ¼lemek iÃ§in eriÅŸim kodunu giriniz.
                </p>
                
                <form @submit.prevent="checkPassword">
                    <input 
                        v-model="passwordInput" 
                        type="password" 
                        placeholder="EriÅŸim Kodu"
                        class="w-full px-4 py-3 text-center rounded-xl border-0 ring-1 ring-inset focus:ring-2 focus:ring-purple-500 outline-none mb-4 text-lg tracking-widest transition-all"
                        :class="isDarkMode ? 'bg-gray-800 text-white ring-gray-600 placeholder-gray-500' : 'bg-white text-gray-900 ring-gray-300 placeholder-gray-400'"
                        autofocus
                    >
                    <button 
                        type="submit"
                        class="w-full py-3.5 rounded-xl font-bold text-white shadow-lg bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 transition-all transform active:scale-95"
                    >
                        GiriÅŸ Yap
                    </button>
                    <p v-if="loginError" class="text-red-500 text-xs font-bold mt-3 animate-pulse bg-red-100 py-1 px-2 rounded-md inline-block">
                        HatalÄ± kod, tekrar deneyiniz.
                    </p>
                </form>
            </div>
        </div>

        <div v-else class="container mx-auto h-full flex flex-col p-4 lg:p-6 max-w-7xl">
            
            <div class="flex flex-col md:flex-row justify-between items-center mb-4 lg:mb-6 flex-shrink-0 gap-4">
                <div class="flex items-center space-x-3 w-full md:w-auto">
                    <div class="p-2 rounded-lg bg-black text-white shadow-lg">
                        <svg viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6">
                            <path d="M12 0C5.373 0 0 5.373 0 12c0 6.627 5.373 12 12 12s12-5.373 12-12c0-6.627-5.373-12-12-12zm6 13h-4.5v4.5h-3V13H6v-3h4.5V5.5h3V10H18v3z" fill-opacity="0"/>
                            <path d="M19 4H5a2 2 0 00-2 2v12a2 2 0 002 2h14a2 2 0 002-2V6a2 2 0 00-2-2zm-7 3c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm5 10H7v-2h10v2zm0-4H7v-2h10v2z" fill="white"/>
                        </svg>
                    </div>
                    <h1 class="font-bold text-xl md:text-2xl tracking-tight" :class="isDarkMode ? 'text-white' : 'text-gray-900'">
                        Mesaj OluÅŸturucu
                    </h1>
                </div>
                
                <div class="flex items-center gap-2 w-full md:w-auto justify-end">
                    <button @click="downloadBackup" class="text-xs font-bold px-3 py-1.5 rounded-full border border-current opacity-60 hover:opacity-100 transition-opacity flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                        Yedekle
                    </button>
                    <button v-if="hasDeletedDefaults" @click="restoreDefaults" class="text-xs font-bold px-3 py-1.5 rounded-full border border-current opacity-60 hover:opacity-100 transition-opacity">
                        SÄ±fÄ±rla
                    </button>
                    <button @click="toggleTheme" class="p-2 rounded-full transition-colors hover:bg-white/10 focus:outline-none">
                        <svg v-if="!isDarkMode" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                        <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                    </button>
                    <button @click="logout" class="text-xs font-bold px-3 py-1.5 rounded-full bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition-all ml-2">
                        Ã‡Ä±kÄ±ÅŸ
                    </button>
                </div>
            </div>

            <div class="flex-1 grid grid-cols-1 lg:grid-cols-12 gap-6 overflow-hidden">
                
                <div class="lg:col-span-5 flex flex-col gap-4 overflow-y-auto custom-scroll pr-1 pb-2">
                    
                    <div class="p-6 rounded-3xl shadow-xl transition-all duration-300 flex-shrink-0"
                         :class="isDarkMode ? 'glass-dark' : 'glass'">
                        
                        <h2 class="text-xs font-bold uppercase tracking-wider opacity-60 mb-4" :class="isDarkMode ? 'text-gray-100' : 'text-gray-700'">
                            MÃ¼ÅŸteri Bilgileri
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="space-y-1">
                                <label class="text-xs font-semibold ml-1 opacity-80" :class="isDarkMode ? 'text-gray-200' : 'text-gray-700'">MÃ¼ÅŸteri AdÄ±</label>
                                <input 
                                    v-model="form.name" 
                                    type="text" 
                                    placeholder="Ahmet YÄ±lmaz"
                                    class="w-full px-4 py-3 rounded-xl border-0 ring-1 ring-inset focus:ring-2 focus:ring-purple-500 transition-all outline-none"
                                    :class="isDarkMode ? 'bg-gray-800 text-white ring-gray-600 placeholder-gray-400' : 'bg-white text-gray-900 ring-gray-200 placeholder-gray-400'"
                                >
                            </div>

                            <div class="space-y-1">
                                <div class="flex justify-between items-center px-1">
                                    <label class="text-xs font-semibold opacity-80" :class="isDarkMode ? 'text-gray-200' : 'text-gray-700'">Telefon</label>
                                    <span v-if="isPhoneValid" class="text-[10px] font-bold text-green-500 flex items-center animate-fade-in">
                                        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                        GeÃ§erli
                                    </span>
                                </div>
                                <input 
                                    v-model="form.phone" 
                                    @input="formatPhone"
                                    type="tel" 
                                    placeholder="5XX XXX XX XX"
                                    class="w-full px-4 py-3 rounded-xl border-0 ring-1 ring-inset focus:ring-2 transition-all outline-none"
                                    :class="[
                                        isDarkMode ? 'bg-gray-800 text-white placeholder-gray-400' : 'bg-white text-gray-900 placeholder-gray-400',
                                        isPhoneValid 
                                            ? 'ring-2 ring-green-500 focus:ring-green-600' 
                                            : (isDarkMode ? 'ring-gray-600 focus:ring-purple-500' : 'ring-gray-200 focus:ring-purple-500')
                                    ]"
                                >
                            </div>

                            <div class="space-y-1">
                                <label class="text-xs font-semibold ml-1 opacity-80" :class="isDarkMode ? 'text-gray-200' : 'text-gray-700'">Temsilci AdÄ±</label>
                                <input 
                                    v-model="form.isrName" 
                                    type="text" 
                                    placeholder="AdÄ±nÄ±z SoyadÄ±nÄ±z"
                                    class="w-full px-4 py-3 rounded-xl border-0 ring-1 ring-inset focus:ring-2 focus:ring-purple-500 transition-all outline-none"
                                    :class="isDarkMode ? 'bg-gray-800 text-white ring-gray-600 placeholder-gray-400' : 'bg-white text-gray-900 ring-gray-200 placeholder-gray-400'"
                                >
                            </div>
                        </div>
                    </div>

                    <div class="flex-1 flex flex-col p-6 rounded-3xl shadow-xl transition-all duration-300"
                         :class="isDarkMode ? 'glass-dark' : 'glass'">
                        
                        <h2 class="text-xs font-bold uppercase tracking-wider opacity-60 mb-2" :class="isDarkMode ? 'text-gray-100' : 'text-gray-700'">
                            Mesaj Ã–nizleme
                        </h2>
                        
                        <textarea 
                            v-model="computedMessage" 
                            class="flex-1 w-full px-4 py-3 rounded-xl border-0 ring-1 ring-inset focus:ring-2 focus:ring-purple-500 transition-all outline-none resize-none min-h-[150px] mb-4"
                            :class="isDarkMode ? 'bg-gray-900 text-white ring-gray-600' : 'bg-white text-gray-900 ring-gray-200'"
                            placeholder="SaÄŸ taraftan bir ÅŸablon seÃ§in..."
                        ></textarea>

                        <div class="flex gap-2 mt-auto">
                            <a 
                                :href="'tel:' + form.phone.replace(/\D/g, '')"
                                class="flex items-center justify-center p-3.5 rounded-xl font-bold transition-transform active:scale-95 shadow-lg group w-16"
                                :class="[
                                    isDarkMode ? 'bg-blue-600 hover:bg-blue-500 text-white' : 'bg-blue-500 hover:bg-blue-400 text-white',
                                    !isPhoneValid ? 'opacity-50 pointer-events-none' : ''
                                ]"
                                title="Hemen Ara"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                </svg>
                            </a>

                            <button 
                                @click="copyText"
                                class="flex-1 flex items-center justify-center py-3.5 rounded-xl font-bold transition-transform active:scale-95 shadow-lg group"
                                :class="isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-white' : 'bg-white hover:bg-gray-50 text-gray-800'"
                            >
                                <span v-if="!copied" class="flex items-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 opacity-60" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                    Kopyala
                                </span>
                                <span v-else class="text-green-500 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                                    KopyalandÄ±
                                </span>
                            </button>
                            
                            <button 
                                @click="sendWhatsApp"
                                class="flex-1 flex items-center justify-center py-3.5 rounded-xl font-bold text-white shadow-lg bg-gradient-to-r from-green-500 to-green-600 hover:from-green-400 hover:to-green-500 transition-all transform active:scale-95"
                            >
                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                                GÃ¶nder
                            </button>
                        </div>
                    </div>

                </div>

                <div class="lg:col-span-7 flex flex-col overflow-hidden rounded-3xl shadow-xl transition-all duration-300"
                     :class="isDarkMode ? 'glass-dark' : 'glass'">
                    
                    <div class="p-6 h-full flex flex-col">
                        
                        <div class="mb-2 space-y-3">
                            <div class="flex justify-between items-center">
                                <h2 class="text-xs font-bold uppercase tracking-wider opacity-60" :class="isDarkMode ? 'text-gray-100' : 'text-gray-700'">Åžablonlar</h2>
                                <button @click="showAddTemplate = !showAddTemplate" class="text-xs font-semibold text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300 transition-colors flex items-center">
                                    <span v-if="!showAddTemplate" class="flex items-center gap-1">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                        </svg>
                                        Yeni Åžablon
                                    </span>
                                    <span v-else>Ä°ptal</span>
                                </button>
                            </div>

                            <div class="flex gap-2 overflow-x-auto hide-scrollbar pb-1">
                                <button 
                                    @click="activeFilter = 'TÃ¼mÃ¼'"
                                    class="text-[11px] font-bold px-3 py-1.5 rounded-full whitespace-nowrap transition-all border"
                                    :class="activeFilter === 'TÃ¼mÃ¼' 
                                        ? (isDarkMode ? 'bg-white text-black border-white' : 'bg-gray-900 text-white border-gray-900') 
                                        : (isDarkMode ? 'bg-transparent text-gray-400 border-gray-700 hover:border-gray-400' : 'bg-white text-gray-500 border-gray-200 hover:border-gray-400')"
                                >
                                    TÃ¼mÃ¼
                                </button>
                                <button 
                                    v-for="cat in availableCategories" 
                                    :key="cat"
                                    @click="activeFilter = cat"
                                    class="text-[11px] font-bold px-3 py-1.5 rounded-full whitespace-nowrap transition-all border"
                                    :class="activeFilter === cat 
                                        ? (isDarkMode ? 'bg-white text-black border-white' : 'bg-gray-900 text-white border-gray-900') 
                                        : (isDarkMode ? 'bg-transparent text-gray-400 border-gray-700 hover:border-gray-400' : 'bg-white text-gray-500 border-gray-200 hover:border-gray-400')"
                                >
                                    {{ cat }}
                                </button>
                            </div>

                            <div class="relative">
                                <span class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <svg class="h-4 w-4 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                                    </svg>
                                </span>
                                <input 
                                    v-model="searchQuery"
                                    type="text"
                                    placeholder="Åžablonlarda ara..."
                                    class="w-full pl-9 pr-4 py-2 text-sm rounded-xl border-0 ring-1 ring-inset focus:ring-2 focus:ring-purple-500 transition-all outline-none"
                                    :class="isDarkMode ? 'bg-gray-800 text-white ring-gray-600 placeholder-gray-400' : 'bg-white text-gray-900 ring-gray-200 placeholder-gray-500'"
                                >
                            </div>

                            <div v-if="showAddTemplate" class="p-4 rounded-2xl border border-dashed transition-all duration-300 animate-fade-in-down"
                                 :class="isDarkMode ? 'bg-gray-800/50 border-gray-600' : 'bg-white/80 border-gray-300'">
                                
                                <div class="mb-3">
                                    <label class="text-[10px] font-bold uppercase tracking-wide mb-1 block opacity-60">Kategori</label>
                                    <input 
                                        v-model="newTemplateCategory" 
                                        type="text"
                                        placeholder="Kategori yazÄ±n veya aÅŸaÄŸÄ±dan seÃ§in..."
                                        class="w-full px-3 py-2 text-xs rounded-lg border outline-none mb-2"
                                        :class="isDarkMode ? 'bg-gray-700 text-white border-gray-600' : 'bg-white text-gray-800 border-gray-200'"
                                    >
                                    <div class="flex gap-2 flex-wrap">
                                        <button 
                                            v-for="cat in ['TanÄ±ÅŸma', 'Kampanya', 'Takip', 'Genel']" 
                                            @click="newTemplateCategory = cat"
                                            class="text-[10px] px-2 py-1 rounded border opacity-70 hover:opacity-100 transition-opacity"
                                            :class="isDarkMode ? 'border-gray-600 text-gray-300' : 'border-gray-300 text-gray-600'"
                                        >
                                            {{ cat }}
                                        </button>
                                    </div>
                                </div>

                                <textarea 
                                    v-model="newTemplateText"
                                    rows="3"
                                    placeholder="Metnini buraya yapÄ±ÅŸtÄ±r..."
                                    class="w-full px-3 py-2 text-sm rounded-lg resize-none outline-none focus:ring-2 focus:ring-purple-500 mb-3 border"
                                    :class="isDarkMode ? 'bg-gray-900 text-white border-gray-700 placeholder-gray-500' : 'bg-white text-gray-900 border-gray-200 placeholder-gray-400'"
                                ></textarea>
                                
                                <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3">
                                    <div class="flex gap-2 text-xs flex-wrap">
                                        <button @click="insertVar('{name}')" class="px-2 py-1.5 rounded-md font-semibold bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-200 border border-purple-200 dark:border-purple-700 hover:scale-105 transition-transform">
                                            + {name}
                                        </button>
                                        <button @click="insertVar('{isr}')" class="px-2 py-1.5 rounded-md font-semibold bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-200 border border-blue-200 dark:border-blue-700 hover:scale-105 transition-transform">
                                            + {isr}
                                        </button>
                                    </div>
                                    <button 
                                        @click="saveNewTemplate"
                                        :disabled="!newTemplateText"
                                        class="w-full sm:w-auto px-5 py-2 text-xs font-bold uppercase tracking-wider rounded-lg shadow-md transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                                        :class="isDarkMode ? 'bg-purple-600 text-white hover:bg-purple-500' : 'bg-gray-900 text-white hover:bg-gray-700'"
                                    >
                                        Ekle
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="flex-1 overflow-y-auto custom-scroll pr-1 space-y-3">
                            <div 
                                v-for="(item, i) in filteredMessages" 
                                :key="item.index"
                                @click="selectTemplate(item)"
                                class="group relative flex flex-col p-4 rounded-xl cursor-pointer transition-all duration-200 border-l-4"
                                :class="[
                                    currentRawMessage === item.content.text 
                                        ? 'bg-purple-500/10 border-purple-500 shadow-md' 
                                        : (isDarkMode ? 'bg-gray-800/60 border-transparent hover:bg-gray-800' : 'bg-white shadow-sm border-transparent hover:shadow-md hover:bg-gray-50')
                                ]"
                            >
                                <div class="flex justify-between items-start mb-2">
                                    <span class="text-[10px] uppercase font-bold px-2 py-0.5 rounded-full tracking-wide"
                                          :class="getCategoryColor(item.content.category)">
                                        {{ item.content.category || 'Genel' }}
                                    </span>
                                </div>

                                <div class="flex-1 pr-8">
                                    <p class="text-sm whitespace-pre-line leading-relaxed pointer-events-none transition-all"
                                       :class="isDarkMode ? 'text-gray-200' : 'text-gray-700'">
                                        {{ item.content.text
                                            .replace('{name}', form.name ? form.name : '...') 
                                            .replace('{isr}', form.isrName ? form.isrName : '...') 
                                        }}
                                    </p>
                                </div>
                                
                                <button 
                                    @click.stop="deleteTemplate(item.index)" 
                                    class="absolute top-2 right-2 p-2 rounded-lg opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500 hover:bg-red-500/10 transition-all"
                                    title="Åžablonu Sil"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>
                            </div>
                            
                            <div v-if="filteredMessages.length === 0" class="text-center py-10 opacity-60">
                                <p v-if="searchQuery">Aranan kriterde ÅŸablon bulunamadÄ±.</p>
                                <p v-else-if="activeFilter !== 'TÃ¼mÃ¼'">Bu kategoride ÅŸablon yok.</p>
                                <p v-else>HiÃ§ ÅŸablon kalmadÄ±.</p>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, watch, onMounted } = Vue;

        createApp({
            setup() {
                // AUTH STATE
                const isAuthenticated = ref(false);
                const passwordInput = ref('');
                const loginError = ref(false);
                const COMPANY_CODE = 'ikasaog2025'; // CHANGE THIS PASSWORD

                // APP STATE
                const isDarkMode = ref(false);
                const showAddTemplate = ref(false);
                const newTemplateText = ref('');
                const newTemplateCategory = ref('Genel');
                const searchQuery = ref('');
                const activeFilter = ref('TÃ¼mÃ¼');
                const copied = ref(false);
                const currentRawMessage = ref('');
                const hasDeletedDefaults = ref(false);
                
                const form = ref({
                    name: '',
                    isrName: '',
                    phone: '',
                    message: ''
                });

                // Default Messages
                const defaultMessages = [
                    { category: 'TanÄ±ÅŸma', text: 'Merhaba {name}, Ben ikas e-ticaret altyapÄ±sÄ±ndan ulaÅŸÄ±yorum size adÄ±m {isr}. Panelimizden bir demo hesap oluÅŸturmuÅŸsunuz online satÄ±ÅŸ sitenizi aÃ§makla mÄ± ilgileniyorsunuz acaba? Destek olmak isterim.' },
                    { category: 'Takip', text: 'Merhaba {name}, ben ikas e-ticaret altyapÄ±sÄ±ndan {isr}. DoldurduÄŸunuz ulaÅŸÄ±m formuna istinaden sizi aradÄ±m ancak ulaÅŸamadÄ±m. MÃ¼sait olduÄŸunuzda gÃ¶rÃ¼ÅŸmek ve size yardÄ±mcÄ± olmak isterim. Sevgiler.' },
                    { category: 'Kampanya', text: 'Merhaba {name}, ben ikas e-ticaret altyapÄ±sÄ±ndan {isr}. Uzun zamandÄ±r sizlerle gÃ¶rÃ¼ÅŸme fÄ±rsatÄ±mÄ±z olamadÄ±. UmarÄ±z her ÅŸey yolundadÄ±r. Sizlere Ã¶zel bir fÄ±rsattan bahsetmek istiyorum. Daha Ã¶nce ilgilendiÄŸiniz Ã¼rÃ¼n/hizmetlerimiz iÃ§in sÄ±nÄ±rlÄ± sayÄ±da kullanÄ±cÄ±larÄ±mÄ±za sunduÄŸumuz Ã¶zel indirimler sÃ¶z konusu. KampanyamÄ±z kÄ±sa sÃ¼reliÄŸine geÃ§erli olduÄŸundan dolayÄ± sizlerle fÄ±rsat hakkÄ±nda bir telefon gÃ¶rÃ¼ÅŸmesi yapmayÄ± Ã§ok isteriz. Bu fÄ±rsatÄ± kaÃ§Ä±rmamanÄ±zÄ± Ã¶neririm. Sizin iÃ§in uygun bir zamanda gÃ¶rÃ¼ÅŸmek Ã¼zere geri dÃ¶nÃ¼ÅŸÃ¼nÃ¼zÃ¼ bekliyorum.' },
                    { category: 'Kampanya', text: 'Merhaba {name}, ben {isr} â€“ Ä°kas e-ticaret altyapÄ±sÄ±ndan.\nDaha Ã¶nce sizinle kÄ±sa bir iletiÅŸimimiz olmuÅŸtu ancak sonrasÄ±nda bir tÃ¼rlÃ¼ gÃ¶rÃ¼ÅŸme fÄ±rsatÄ±mÄ±z olmadÄ±.\nÅžu an sadece sÄ±nÄ±rlÄ± sayÄ±da iÅŸletme iÃ§in geÃ§erli olan, %50â€™ye varan indirimlerin olduÄŸu Ã¶zel bir kampanya sÃ¼recine giriyoruz.\nBu mesajÄ±, kampanyayÄ± baÅŸlamadan Ã¶nce ilk duyuranlardan biri olarak paylaÅŸmak istedim.\nâœ… Site kurulum desteÄŸi\nâœ… Ek modÃ¼l ve entegrasyon avantajlarÄ±\nâœ… Vade farksÄ±z Ã¶deme seÃ§enekleri\nve daha fazlasÄ± bu kampanyaya dahil olacak.\nÄ°lgilenirseniz, detaylarÄ± hemen paylaÅŸabilirim. KÄ±sa sÃ¼reli ve kontenjanla sÄ±nÄ±rlÄ± bir fÄ±rsat olduÄŸu iÃ§in erken dÃ¶nÃ¼ÅŸ yaparsanÄ±z Ã§ok memnun olurum.' },
                    { category: 'Kampanya', text: 'ðŸš€ ikas Scale Paket â€“ YÄ±lÄ±n Son BÃ¼yÃ¼k FÄ±rsatÄ±!\n\Merhaba {name}, %40 net indirim ile sadece 39.948 TL + KDV\nðŸ’³ Vade farksÄ±z 6 taksit\nðŸŽ 12.000 TL deÄŸerinde kargo bakiyesi HEDÄ°YE!\nâœ… SÄ±nÄ±rsÄ±z trafik\nâœ… Pazaryeri entegrasyonlarÄ±\nâš¡ 3 GÃ¼nde Siteni Kur â€“ SÃ¼per kolay kullanÄ±m!\n\nE-ticaretini bÃ¼yÃ¼tmek iÃ§in en doÄŸru zaman!\nâ³ Kampanya sÃ¼resi sÄ±nÄ±rlÄ±dÄ±r.' },
                    { category: 'Kampanya', text: 'ðŸš€ ikas Scale Plus Paket â€“ YÄ±lÄ±n Son FÄ±rsatÄ±!\n\Merhaba {name}, %40 net indirim ile sadece 69.948 TL + KDV\nðŸ’³ Vade farksÄ±z 9 taksit\nðŸŽ 18.000 TL deÄŸerinde kargo bakiyesi HEDÄ°YE!\nâœ… 19 pazaryeri entegrasyonu\nâœ… Mobil uygulama\nâœ… VIP mÃ¼ÅŸteri temsilcisi\nâš¡ 3 GÃ¼nde Siteni Kur â€“ Ãœst dÃ¼zey kullanÄ±m kolaylÄ±ÄŸÄ±!\n\nE-ticaretinizi gÃ¼Ã§lendirmek iÃ§in mÃ¼kemmel zaman!\nâ³ Kampanya sÃ¼resi sÄ±nÄ±rlÄ±dÄ±r.' }
                ];

                const messages = ref([...defaultMessages]);

                // Load saved state
                onMounted(() => {
                    // Check Session Auth
                    if (sessionStorage.getItem('ikas_auth') === 'true') {
                        isAuthenticated.value = true;
                    }

                    const savedMessages = localStorage.getItem('ikas_all_messages');
                    if (savedMessages) {
                        try {
                            const parsed = JSON.parse(savedMessages);
                            if (parsed.length > 0 && typeof parsed[0] === 'string') {
                                messages.value = parsed.map(msg => ({ text: msg, category: 'Genel' }));
                            } else {
                                messages.value = parsed;
                            }
                            if (messages.value.length !== defaultMessages.length) {
                                hasDeletedDefaults.value = true;
                            }
                        } catch(e) { console.error('Migration error', e); }
                    }
                    
                    const savedTheme = localStorage.getItem('ikas_theme');
                    if (savedTheme === 'dark') isDarkMode.value = true;

                    const savedIsr = localStorage.getItem('ikas_isr_name');
                    if (savedIsr) form.value.isrName = savedIsr;

                    const sessionData = sessionStorage.getItem('ikas_session_form');
                    if (sessionData) {
                        const parsedSession = JSON.parse(sessionData);
                        if (parsedSession.name) form.value.name = parsedSession.name;
                        if (parsedSession.phone) form.value.phone = parsedSession.phone;
                    }
                });

                // --- AUTH METHODS ---
                const checkPassword = () => {
                    if (passwordInput.value === COMPANY_CODE) {
                        isAuthenticated.value = true;
                        loginError.value = false;
                        sessionStorage.setItem('ikas_auth', 'true');
                    } else {
                        loginError.value = true;
                        setTimeout(() => loginError.value = false, 2000);
                    }
                };

                const logout = () => {
                    isAuthenticated.value = false;
                    passwordInput.value = '';
                    sessionStorage.removeItem('ikas_auth');
                };

                // --- COMPUTED ---
                const availableCategories = computed(() => {
                    const cats = new Set(messages.value.map(m => m.category || 'Genel'));
                    return Array.from(cats).sort();
                });

                const filteredMessages = computed(() => {
                    return messages.value
                        .map((msg, index) => ({ content: msg, index }))
                        .filter(item => {
                            if (searchQuery.value) {
                                const query = searchQuery.value.toLowerCase();
                                return item.content.text.toLowerCase().includes(query) || 
                                       (item.content.category && item.content.category.toLowerCase().includes(query));
                            }
                            if (activeFilter.value !== 'TÃ¼mÃ¼') {
                                return item.content.category === activeFilter.value;
                            }
                            return true;
                        });
                });

                const computedMessage = computed({
                    get() { return form.value.message; },
                    set(val) { form.value.message = val; }
                });

                const isPhoneValid = computed(() => {
                    const clean = form.value.phone.replace(/\D/g, '');
                    return clean.length >= 10 && clean.length <= 13;
                });

                // --- WATCHERS ---
                watch(form, (newVal) => {
                    sessionStorage.setItem('ikas_session_form', JSON.stringify({
                        name: newVal.name,
                        phone: newVal.phone
                    }));
                }, { deep: true });

                watch([() => form.value.name, () => form.value.isrName, currentRawMessage], () => {
                    compileMessage();
                });

                watch(() => form.value.isrName, (newVal) => {
                    localStorage.setItem('ikas_isr_name', newVal);
                });

                watch(isDarkMode, (newVal) => {
                    localStorage.setItem('ikas_theme', newVal ? 'dark' : 'light');
                });

                watch(messages, (newVal) => {
                    localStorage.setItem('ikas_all_messages', JSON.stringify(newVal));
                }, { deep: true });

                // --- METHODS ---
                const getCategoryColor = (cat) => {
                    const c = cat ? cat.toLowerCase() : 'genel';
                    if (c.includes('tanÄ±ÅŸma') || c.includes('merhaba')) return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';
                    if (c.includes('kampanya') || c.includes('fÄ±rsat')) return 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200';
                    if (c.includes('takip')) return 'bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200';
                    if (c.includes('vip') || c.includes('Ã¶zel')) return 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200';
                    return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';
                };

                const toggleTheme = () => isDarkMode.value = !isDarkMode.value;
                const insertVar = (variable) => newTemplateText.value += variable + ' ';

                const compileMessage = () => {
                    if (!currentRawMessage.value) return;
                    let namePart = form.value.name || '';
                    let isrPart = form.value.isrName || '';
                    let txt = currentRawMessage.value
                        .replace(/{name}/g, namePart)
                        .replace(/{isr}/g, isrPart);
                    if (!namePart) {
                         txt = txt.replace(' ,', ',');
                         txt = txt.replace('Merhaba ,', 'Merhaba,');
                    }
                    form.value.message = txt;
                };

                const selectTemplate = (item) => {
                    currentRawMessage.value = item.content.text;
                    compileMessage();
                };

                const formatPhone = (e) => {
                    let input = e.target.value;
                    let clean = input.replace(/\D/g, '');
                    if (clean.length > 0) {
                        if (clean.startsWith('90')) {} 
                        else if (clean.startsWith('0')) clean = '9' + clean;
                        else if (clean.startsWith('5')) clean = '90' + clean;
                        else if(clean.length >= 10 && !clean.startsWith('90')) clean = '90' + clean;
                    }
                    if (clean.length > 12) clean = clean.slice(0, 12);
                    form.value.phone = clean;
                };

                const saveNewTemplate = () => {
                    if (!newTemplateText.value) return;
                    messages.value.unshift({
                        text: newTemplateText.value,
                        category: newTemplateCategory.value || 'Genel'
                    });
                    searchQuery.value = '';
                    activeFilter.value = newTemplateCategory.value || 'Genel';
                    currentRawMessage.value = newTemplateText.value;
                    compileMessage();
                    newTemplateText.value = '';
                    showAddTemplate.value = false;
                };

                const deleteTemplate = (originalIndex) => {
                    if(!confirm('Bu ÅŸablonu silmek istediÄŸine emin misin?')) return;
                    messages.value.splice(originalIndex, 1);
                    hasDeletedDefaults.value = true;
                    if (messages.value.length === 0) form.value.message = '';
                };

                const restoreDefaults = () => {
                    if(!confirm('TÃ¼m Ã¶zel ÅŸablonlarÄ±nÄ±z silinecek ve varsayÄ±lanlar geri yÃ¼klenecek. Ã–nce "Yedekle" butonunu kullanmanÄ±z Ã¶nerilir. OnaylÄ±yor musunuz?')) return;
                    messages.value = [...defaultMessages];
                    hasDeletedDefaults.value = false;
                    activeFilter.value = 'TÃ¼mÃ¼';
                };
                
                const downloadBackup = () => {
                    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(messages.value, null, 2));
                    const downloadAnchorNode = document.createElement('a');
                    downloadAnchorNode.setAttribute("href", dataStr);
                    downloadAnchorNode.setAttribute("download", "ikas_sablon_yedek.json");
                    document.body.appendChild(downloadAnchorNode);
                    downloadAnchorNode.click();
                    downloadAnchorNode.remove();
                };

                const copyText = () => {
                    if (!form.value.message) return;
                    navigator.clipboard.writeText(form.value.message).then(() => {
                        copied.value = true;
                        setTimeout(() => copied.value = false, 2000);
                    });
                };

                const sendWhatsApp = () => {
                    if (!form.value.phone) {
                        alert('LÃ¼tfen bir telefon numarasÄ± giriniz.');
                        return;
                    }
                    const cleanPhone = form.value.phone.replace(/\D/g, '');
                    const url = `https://api.whatsapp.com/send?phone=${cleanPhone}&text=${encodeURIComponent(form.value.message)}`;
                    window.open(url, '_blank');
                };

                return {
                    isAuthenticated, passwordInput, loginError, checkPassword, logout,
                    isDarkMode, toggleTheme, form, messages, filteredMessages, showAddTemplate,
                    newTemplateText, newTemplateCategory, searchQuery, activeFilter, availableCategories,
                    insertVar, copied, currentRawMessage, computedMessage, formatPhone, selectTemplate, 
                    saveNewTemplate, deleteTemplate, copyText, sendWhatsApp, restoreDefaults, 
                    hasDeletedDefaults, getCategoryColor, isPhoneValid, downloadBackup
                };
            }
        }).mount('#app');
    </script>
</body>
</html>